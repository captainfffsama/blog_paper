

[toc]

# 前言

来自 ICCV 2021 的一篇使用重建类方法来做异常检测和定位的文章，本身创新点不算多，但是提出了一个控制生成类模型重建效果的方法，值得学习。

# 任务背景简述

在现实工业场景中，异常作为一种偶发事件，通常难以收集到大量的标注样本。且很多异常，比如工件生产产生裂纹汽泡，布料生成时有勾线斑点等，这些异常本身很细微且难以用严格的标准来进行标注，甚至有些异常压根没法提前预知是何种模样，因此压根没法收集到足够的异常样本来使用监督学习教会模型什么是异常。

既然直接正面硬刚根本找不到异常样本，那么干脆在学习阶段我们就放弃异常样本，直接尝试教会模型什么样的样本是正常的，然后剩下不符合正常样本特征的都统统算是异常，即将异常检测任务是为是一种离群检测任务。

那么剩下的问题，就变成了我们如何学习到正常样本的分布了，或者说是构建一个合理的关于正常样本的描述。

那一种常见思路是将正常样本经过特征提取之后映射到特征空间，然后在特征空间上采用聚类或者是直接认为特征符合多元高斯分布，求出聚类中心或者是高斯分布，剩下待测数据通过检测和聚类中心的距离或者是分布的距离就可以确定它是否正常了。

还有一种常见思路就是直接上一个重建模型，我们使用大量正常样本学习一个重建模型。这样只要模型 train 得够牛逼，那应该正常样本都是可以完好无损的重建出来的，异常样本由于从来没参与过模型的训练，那么异常样本要么是直接被重建成正常样本了，要么异常区域根本就没法重建出来啊。这样我们再计算一下重建模型输入和输出的误差，那误差大的不就是异常样本了么？

看到这肯定有鸡贼的小伙伴说：嗨呀，那这也太易贼了。看我直接 Adam 配 $3e^{-4}$​ ,一发 AE 通关异常检测。

然而，理想很丰满，现实很骨感，这种很 young 很 simple 的想法确实能搞定一部分明显大到离谱的缺陷，但是对于大量比如一个小裂纹，一个小破洞之类的缺陷，就很难train出一个重建模型来有效区分。

# 现存问题

AE 产生图像糊已经是人尽皆知的问题了



# 论文解法

# 其他细节

